{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "IOCRecord",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "type": {
      "type": "string",
      "enum": ["ip", "domain", "url", "hash_md5", "hash_sha1", "hash_sha256", "email", "unknown"]
    },
    "value": {
      "type": "string",
      "minLength": 1
    },
    "source": {
      "type": "string",
      "minLength": 1
    },
    "first_seen": {
      "type": "string",
      "oneOf": [
        {"format": "date-time"},
        {"const": ""}
      ]
    },
    "last_seen": {
      "type": "string",
      "oneOf": [
        {"format": "date-time"},
        {"const": ""}
      ]
    },
    "confidence": {
      "type": "integer",
      "minimum": 1,
      "maximum": 5
    },
    "context": {
      "type": "string"
    },
    "tags": {
      "type": "array",
      "items": {"type": "string"}
    },
    "reference_ids": {
      "type": "array",
      "items": {"type": "string"}
    },
    "pack": {
      "type": "string"
    }
  },
  "required": ["type", "value", "source", "confidence"]
}
